<div class="container">
    <div class="row">
        <div id="console-output" class="col" style="height: 500px; overflow: scroll; font-family: monospace; color: white; background-color: black">
        </div>
    </div>
    <div class="row">
        <div class="col">
            <button onclick="reset()">Reset</button>
        </div>
    </div>
</div>

<script type="text/javascript">
    fetch('/media_content')
        .then(response => response.json())
        .then(data => {
            for (var line of data) {
                document.getElementById('console-output').innerHTML += line + "<br>"
            }
        })

    /*
    * enum Message {
    *     NewConsoleOutput(MessageBody),
    *     Error(MessageBody),
    *     Finished,
    * }
    * */

    webSocket = new WebSocket("ws://localhost:8080/ws_notification")
    webSocket.onmessage = function (event) {
        const message = event.data
        var line_text = ""
        if (message.type === "NewConsoleMessage") {
            line_text = message.body
        } else if (message.type === "Error") {
            line_text = "<span style='color:red'>"+message.body+"</span>"
        } else if (message.type === "Finished") {
            line_text = "<span style='color:green'>"+"Photogrammetry Abgeschlossen"+"</span>"
        } else {
            line_text = "<span style='color:red'>"+"inavid message type"+"</span>"
        }
        document.getElementById('console-output').innerHTML += line_text + "<br>"
    }

    function reset() {
        fetch("/", {
            method: "delete"
        }).then(res => alert(res.status)).then(_ => location.reload())
    }
</script>